<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compare two objects — compare • waldo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compare two objects — compare" />
<meta property="og:description" content="This compares two R objects, identifying the key differences. It:
Orders the differences from most important to least important.
Displays the values of atomic vectors that are actually different.
Carefully uses colour to emphasise changes (while still being readable
when colour isn't available).
Uses R code (not a text description) to show where differences arise.
Where possible, it compares elements by name, rather than by position.
Errs on the side of producing too much output, rather than too little.


compare() is an alternative to all.equal()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">waldo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/waldo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compare two objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/waldo/blob/master/R/compare.R'><code>R/compare.R</code></a></small>
    <div class="hidden name"><code>compare.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This compares two R objects, identifying the key differences. It:</p><ul>
<li><p>Orders the differences from most important to least important.</p></li>
<li><p>Displays the values of atomic vectors that are actually different.</p></li>
<li><p>Carefully uses colour to emphasise changes (while still being readable
when colour isn't available).</p></li>
<li><p>Uses R code (not a text description) to show where differences arise.</p></li>
<li><p>Where possible, it compares elements by name, rather than by position.</p></li>
<li><p>Errs on the side of producing too much output, rather than too little.</p></li>
</ul>

<p><code>compare()</code> is an alternative to <code><a href='https://rdrr.io/r/base/all.equal.html'>all.equal()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>compare</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  <span class='va'>...</span>,
  x_arg <span class='op'>=</span> <span class='st'>"old"</span>,
  y_arg <span class='op'>=</span> <span class='st'>"new"</span>,
  tolerance <span class='op'>=</span> <span class='cn'>NULL</span>,
  max_diffs <span class='op'>=</span> <span class='kw'>if</span> <span class='op'>(</span><span class='fu'>in_ci</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='cn'>Inf</span> <span class='kw'>else</span> <span class='fl'>10</span>,
  ignore_srcref <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ignore_attr <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ignore_encoding <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ignore_function_env <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ignore_formula_env <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x, y</th>
      <td><p>Objects to compare. <code>y</code> is treated as the reference object
so messages describe how <code>x</code> is different to <code>y</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>A handful of other arguments are supported with a warning for
backward compatability. These include:</p><ul>
<li><p><code><a href='https://rdrr.io/r/base/all.equal.html'>all.equal()</a></code> arguments <code>checkNames</code> and <code>check.attributes</code></p></li>
<li><p><code><a href='https://testthat.r-lib.org/reference/compare.html'>testthat::compare()</a></code> argument <code>tol</code></p></li>
</ul>

<p>All other arguments are ignored with a warning.</p></td>
    </tr>
    <tr>
      <th>x_arg, y_arg</th>
      <td><p>Name of <code>x</code> and <code>y</code> arguments, used when generated paths
to internal components. These default to "old" and "new" since it's
most natural to supply the previous value then the new value.</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>If non-<code>NULL</code>, used as threshold for ignoring small
floating point difference when comparing numeric vectors. Setting to
any non-<code>NULL</code> value will cause integer and double vectors to be compared
based on their values, rather than their types.</p>
<p>It uses the same algorithm as <code><a href='https://rdrr.io/r/base/all.equal.html'>all.equal()</a></code>, i.e., first we generate
<code>x_diff</code> and <code>y_diff</code> by subsetting <code>x</code> and <code>y</code> to look only locations
with differences. Then we check that
<code>mean(abs(x_diff - y_diff)) / mean(abs(y_diff))</code> (or just
<code><a href='https://rdrr.io/r/base/mean.html'>mean(abs(x_diff - y_diff))</a></code> if <code>y_diff</code> is small) is less than
<code>tolerance</code>.</p></td>
    </tr>
    <tr>
      <th>max_diffs</th>
      <td><p>Control the maximum number of differences shown. The
default shows 10 differences when run interactively and all differences
when run in CI. Set <code>max_diffs = Inf</code> to see all differences.</p></td>
    </tr>
    <tr>
      <th>ignore_srcref</th>
      <td><p>Ignore differences in function <code>srcref</code>s? <code>TRUE</code> by
default since the <code>srcref</code> does not change the behaviour of a function,
only its printed representation.</p></td>
    </tr>
    <tr>
      <th>ignore_attr</th>
      <td><p>Ignore differences in specified attributes?
Supply a character vector to ignore differences in named attributes.</p>
<p>For backward compatibility with <code><a href='https://rdrr.io/r/base/all.equal.html'>all.equal()</a></code>, you can also use <code>TRUE</code>,
to all ignore differences in all attributes. This is not generally
recommended as it is a blunt tool that will ignore many important
functional differences.</p></td>
    </tr>
    <tr>
      <th>ignore_encoding</th>
      <td><p>Ignore string encoding? <code>TRUE</code> by default, because
this is R's default behaviour. Use <code>FALSE</code> when specifically concerned
with the encoding, not just the value of the string.</p></td>
    </tr>
    <tr>
      <th>ignore_function_env, ignore_formula_env</th>
      <td><p>Ignore the environments of
functions and formulas, respectively? These are provided primarily for
backward compatibility with <code><a href='https://rdrr.io/r/base/all.equal.html'>all.equal()</a></code> which always ignores these
environments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A character vector with class "waldo_compare". If there are no
differences it will have length 0; otherwise each element contains the
description of a single difference.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Thanks to diffobj package comparison of atomic vectors shows differences</span>
<span class='co'># with a little context</span>
<span class='fu'>compare</span><span class='op'>(</span><span class='va'>letters</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"z"</span>, <span class='va'>letters</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>26</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; `old[1:3]`:     <span style='color: #555555;'>"a"</span><span> </span><span style='color: #555555;'>"b"</span><span> </span><span style='color: #555555;'>"c"</span><span>
#&gt; `new[1:4]`: </span><span style='color: #0000BB;'>"z"</span><span> </span><span style='color: #555555;'>"a"</span><span> </span><span style='color: #555555;'>"b"</span><span> </span><span style='color: #555555;'>"c"</span><span>
#&gt; 
#&gt; `old[23:26]`: </span><span style='color: #555555;'>"w"</span><span> </span><span style='color: #555555;'>"x"</span><span> </span><span style='color: #555555;'>"y"</span><span> </span><span style='color: #BBBB00;'>"z"</span><span>
#&gt; `new[24:26]`: </span><span style='color: #555555;'>"w"</span><span> </span><span style='color: #555555;'>"x"</span><span> </span><span style='color: #555555;'>"y"</span><span>    </div><div class='input'><span class='fu'>compare</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; `old`: </span><span style='color: #555555;'>1</span><span> </span><span style='color: #BBBB00;'>2</span><span> </span><span style='color: #555555;'>3</span><span>
#&gt; `new`: </span><span style='color: #555555;'>1</span><span>   </span><span style='color: #555555;'>3</span><span></div><div class='input'><span class='fu'>compare</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; `old`: </span><span style='color: #555555;'>1</span><span> </span><span style='color: #BBBB00;'>2</span><span> </span><span style='color: #555555;'>3</span><span>    
#&gt; `new`: </span><span style='color: #555555;'>1</span><span>   </span><span style='color: #555555;'>3</span><span> </span><span style='color: #0000BB;'>4</span><span> </span><span style='color: #0000BB;'>5</span><span></div><div class='input'><span class='fu'>compare</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; `old`: </span><span style='color: #555555;'>1</span><span> </span><span style='color: #555555;'>2</span><span> </span><span style='color: #00BB00;'>3</span><span>
#&gt; `new`: </span><span style='color: #555555;'>1</span><span> </span><span style='color: #555555;'>2</span><span> </span><span style='color: #00BB00;'>5</span><span></div><div class='input'>
<span class='co'># More complex objects are traversed, stopping only when the types are</span>
<span class='co'># different</span>
<span class='fu'>compare</span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>1</span>, z <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>1</span>, z <span class='op'>=</span> <span class='st'>"a"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; `attr(old$x$y[[1]], 'z')` is </span><span style='color: #00BB00;'>a double vector</span><span> (2)
#&gt; `attr(new$x$y[[1]], 'z')` is </span><span style='color: #00BB00;'>a character vector</span><span> ('a')</div><div class='input'>
<span class='co'># Where possible, recursive structures are compared by name</span>
<span class='fu'>compare</span><span class='op'>(</span><span class='va'>iris</span>, <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     names(old)     | names(new)        
#&gt; [1] </span><span style='color: #BBBB00;'>"Sepal.Length"</span><span> -                   
#&gt; [2] </span><span style='color: #BBBB00;'>"Sepal.Width"</span><span>  -                   
#&gt; [3] </span><span style='color: #BBBB00;'>"Petal.Length"</span><span> -                   
#&gt; [4] </span><span style='color: #BBBB00;'>"Petal.Width"</span><span>  -                   
#&gt; [5] </span><span style='color: #555555;'>"Species"</span><span>      | </span><span style='color: #555555;'>"Species"</span><span>      [1]
#&gt;                    - </span><span style='color: #0000BB;'>"Petal.Width"</span><span>  [2]
#&gt;                    - </span><span style='color: #0000BB;'>"Petal.Length"</span><span> [3]
#&gt;                    - </span><span style='color: #0000BB;'>"Sepal.Width"</span><span>  [4]
#&gt;                    - </span><span style='color: #0000BB;'>"Sepal.Length"</span><span> [5]</div><div class='input'>
<span class='fu'>compare</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"x"</span>, y <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='st'>"y"</span>, x <span class='op'>=</span> <span class='st'>"x"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; `names(old)`: </span><span style='color: #BBBB00;'>"x"</span><span> </span><span style='color: #555555;'>"y"</span><span>    
#&gt; `names(new)`:     </span><span style='color: #555555;'>"y"</span><span> </span><span style='color: #0000BB;'>"x"</span><span></div><div class='input'><span class='co'># Otherwise they're compared by position</span>
<span class='fu'>compare</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; `old[[2]]`: </span><span style='color: #00BB00;'>"y"</span><span>
#&gt; `new[[2]]`: </span><span style='color: #00BB00;'>"z"</span><span></div><div class='input'><span class='fu'>compare</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"x"</span>, x <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"x"</span>, y <span class='op'>=</span> <span class='st'>"z"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; `names(old)`: </span><span style='color: #555555;'>"x"</span><span> </span><span style='color: #00BB00;'>"x"</span><span>
#&gt; `names(new)`: </span><span style='color: #555555;'>"x"</span><span> </span><span style='color: #00BB00;'>"y"</span><span>
#&gt; 
#&gt; `old[[2]]`: </span><span style='color: #00BB00;'>"y"</span><span>
#&gt; `new[[2]]`: </span><span style='color: #00BB00;'>"z"</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


